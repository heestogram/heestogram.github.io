---
layout: single
title: "[R] DACON KBO íƒ€ì OPS ì‹œê°í™” ê²½ì§„ëŒ€íšŒ ì½”ë“œ ë¶„ì„ (2/2)"
excerpt: "DACONì—ì„œ ì£¼ìµœí•œ KBO íƒ€ì OPS ì‹œê°í™” ê²½ì§„ëŒ€íšŒì—ì„œ ì…ìƒí•œ R ì½”ë“œë¥¼ ë¶„ì„í•˜ëŠ” ê¸€ì´ë‹¤."

published: true

categories:
  - R

tags: [R, baseball, Dacon]

toc: true
toc_label: "ëª©ì°¨"
toc_sticky: true

date: 2022-12-09 14:05:00
last_modified_at: 2022-12-09 14:05:00
---

<br>

[KBO íƒ€ì OPS ì‹œê°í™” ê²½ì§„ëŒ€íšŒ ì•ˆë‚´ ë§í¬](https://dacon.io/competitions/official/235546/overview/description)

<div class='notice--primary' markdown='1'>
ğŸ’¡
ë³¸ ëŒ€íšŒëŠ” ì•¼êµ¬ ë°ì´í„°ë¡œ ë¶ˆí™•ì‹¤ì„± ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ 2019ë…„ íƒ€ìë“¤ì˜ ìƒë°˜ê¸° ì„±ì  ì˜ˆì¸¡ì„ ëª©í‘œë¡œ í•©ë‹ˆë‹¤.
2019ë…„ íƒ€ìë“¤ì˜ ìƒë°˜ê¸° OPSë¥¼ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì„ ë§Œë“¤ì–´ ì£¼ì„¸ìš”!
2010ë…„ë¶€í„° 1êµ° ì—”íŠ¸ë¦¬ì— 1ë²ˆ ì´ìƒ í¬í•¨ ë˜ì—ˆë˜ íƒ€ìë“¤ì˜ ì—­ëŒ€ ì •ê·œì‹œì¦Œ, ì‹œë²”ê²½ê¸° ì„±ì  ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.
</div>

ì´ ê¸€ì€ ëŒ€íšŒ ìˆ˜ìƒìì¸ [ê¹€ë¯¼ìˆ˜ ë‹˜ì˜ Rì½”ë“œ](https://dacon.io/competitions/official/235546/codeshare/593?page=1&dtype=recent)ë¥¼ ë¶„ì„í•œ ê²ƒì…ë‹ˆë‹¤.

<br>

[ì´ì „ í¸(ëª¨ë¸ë§ ì´ì „ ë¶€ë¶„) ë³´ëŸ¬ ê°€ê¸°](https://heestogram.github.io/r/dacon-ops/#%ED%8F%89%EA%B0%80-%EB%B0%8F-%EC%98%88%EC%B8%A1)

<br>

## 4. ëª¨ë¸ë§, í•™ìŠµ

ì´ì œ ë¨¸ì‹ ëŸ¬ë‹ìœ¼ë¡œ í•™ìŠµì„í•˜ì—¬ ìµœì ì˜ íŒŒë¼ë¯¸í„°ë¥¼ ì°¾ì•„ë³´ì.

ëª¨ë¸ì€ Lasso, RandomForests, XGBoost ë¥¼ ì‚¬ìš©í•´ ê·¸ ì¤‘ ê°€ì¥ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì´ëŠ” ê²ƒì„ ì´ìš©í•  ê²ƒì´ë‹¤.  

ê·¸ë¦¬ê³  í‰ê°€ëŠ” wrmsë¡œ ì´ë¤„ì§€ê¸° ë–„ë¬¸ì— ìµœì¢… ì„±ëŠ¥ í‰ê°€ëŠ” wrme í•¨ìˆ˜ë¥¼ ë§Œë“¤ì–´ì„œ í•  ê²ƒì´ë‹¤.

```r
wrmse = function(v,w,p){
  sum(sqrt(((v-p)^2*w)/sum(w)))
}

OBP_data <- sum_hf_yr_OBP %>% filter(AB>=30)
SLG_data <- sum_hf_yr_SLG %>% filter(AB>=30)
```

ìš°ì„  **Lasso**ë¶€í„° í•´ë³´ì.

`caret` íŒ¨í‚¤ì§€ë¡œ ê¸°ê³„í•™ìŠµ ëª¨ë¸ë§ì„ í•  ìˆ˜ ìˆë‹¤. `trainControl()`í•¨ìˆ˜ëŠ” ìƒ˜í”Œë§ ê¸°ë²•ì„ ì§€ì •í•œë‹¤. `method=â€™cvâ€™`ëŠ” êµì°¨ê²€ì¦ì„ ì˜ë¯¸í•œë‹¤. ë¶€íŠ¸ìŠ¤íŠ¸ë©ì´ë‚˜ ë°˜ë³µêµì°¨ê²€ì¦ ë“±ì„ ì§€ì •í•  ìˆ˜ë„ ìˆë‹¤.

```r
my_control <- trainControl(method='cv', number=5)
```

`expand.grid()`í•¨ìˆ˜ëŠ” íŒŒë¼ë¯¸í„°ì˜ ê°’ì„ ëª©ë¡ìœ¼ë¡œ ì§€ì •í•œë‹¤. ì•„ë˜ ì½”ë“œëŠ” lambdaê°’ì„ 0.0001~0.03ê¹Œì§€ 0.0005ê°„ê²©ì˜ ëª©ë¡ìœ¼ë¡œ ì„¤ì •í•œ ê²ƒì´ë‹¤.

`train()`í•¨ìˆ˜ëŠ” ëª¨ë¸ì„ í•™ìŠµì‹œí‚¨ë‹¤. ì´ ë•Œ `method` íŒŒë¼ë¯¸í„°ì— ì–´ë–¤ ë¶„ë¥˜/íšŒê·€ ëª¨ë¸ì„ ì‚¬ìš©í• ì§€ ì§€ì •í•œë‹¤. `trControl`ì—” ë¹„êµ ë°©ì‹ì„ ì§€ì •í•˜ê³ , `tuneGrid`ì— íŒŒë¼ë¯¸í„° ëª©ë¡ì„ ì§€ì •í•œë‹¤.

```r
lassogrid <- expand.grid(alpha=1, lambda=seq(0.0001, 0.03, by=0.0005))

set.seed(3409)
lasso_mod_OBP <- train(x=as.data.frame(OBP_data)[,5:9],y=OBP_data$OBP, method='glmnet', trControl=my_control, tuneGrid = lassogrid)

set.seed(0625)
lasso_mod_SLG <- train(x=as.data.frame(SLG_data)[,5:9], y=SLG_data$SLG, method='glmnet', trControl=my_control, tuneGrid = lassogrid)
```

ì´ì œ **Randomforest**ì˜ ì°¨ë¡€ì´ë‹¤.

`expand.grid()`í•¨ìˆ˜ë¡œ `ntree`(íŠ¸ë¦¬ê°œìˆ˜)ë‚˜ `mtry`(ë³€ìˆ˜ê°œìˆ˜)ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë‹¤.

```r
tuneGrid <- expand.grid(.mtry=c(1:4))

set.seed(0110)
RF_mod_OBP <- train(x=OBP_data[,5:9], y=OBP_data$OBP, method='rf', trControl=my_control, tuneGrid = tuneGrid)
set.seed(0110)
RF_mod_SLG <- train(x=SLG_data[,5:9], y=SLG_data$SLG, method='rf', trControl=my_control, tuneGrid = tuneGrid)
```

ë§ˆì§€ë§‰ìœ¼ë¡œ **XGboost**ë¥¼ ì‚¬ìš©í•´ë³´ì. ì´ëŠ” ê·¸ë˜ë””ì–¸íŠ¸ ë¶€ìŠ¤íŒ… ì•Œê³ ë¦¬ì¦˜ì„ ê¸°ë°˜ìœ¼ë¡œ í•œë‹¤.

```r
label_train_OBP <- OBP_data$OBP
dtrain_OBP <- xgb.DMatrix(data=as.matrix(OBP_data[,5:9]), label=label_train_OBP)
label_train_SLG <- SLG_data$SLG
dtrain_SLG <- xgb.DMatrix(data=as.matrix(SLG_data[,5:9]), label=label_train_SLG)
```

ì´ì œ xgbì— ë“¤ì–´ê°ˆ íŒŒë¼ë¯¸í„°ë¥¼ ì§€ì •í•´ì£¼ê³  í›ˆë ¨ì„ ì‹œí‚¤ì

```r
param <- list(
  objective='reg:linear',
  booster='gbtree',
  eta=0.1, #í•™ìŠµë¥ 
  gamma=0, #minimum loss reduction required to make a further partition on a leaf node of the tree
  max_depth=1, #íŠ¸ë¦¬ì˜ ìµœëŒ€ ê¹Šì´
  min_child_weight=1, #ìë…€ë…¸ë“œì˜ í•©ì˜ weightì˜ ìµœì†Ÿê°’
  subsample=1,
  colsample_bytree=1
)

#nroundsëŠ” ìµœëŒ€ë°˜ë³µíšŸìˆ˜ì´ë‹¤.
set.seed(5694)
xgb_mod_OBP <- xgb.train(data=dtrain_OBP, params=param, nrounds=100)
```

## 5. í‰ê°€ ë° ì˜ˆì¸¡

ì´ì œ predictí•˜ê³  evaluateí•  ë•Œì´ë‹¤.

```r
OBP_data$pr_lasso_OBP <- predict(lasso_mod_OBP, OBP_data[,5:9])
OBP_data$pr_RF_OBP <- predict(RF_mod_OBP, OBP_data[,5:9])
OBP_data$pr_XGB_OBP <- predict(xgb_mod_OBP,dtrain_OBP)

cbind('lasso' = wrmse(OBP_data$OBP, OBP_data$AB, OBP_data$pr_lasso_OBP),
      'RF' = wrmse(OBP_data$OBP, OBP_data$AB, OBP_data$pr_RF_OBP),
      'XGB' = wrmse(OBP_data$OBP, OBP_data$AB, OBP_data$pr_XGB_OBP))
#ê²°ê³¼
       lasso       RF       XGB
[1,] 0.9265484 0.4904435 0.9099517

SLG_data$pr_lasso_SLG <- predict(lasso_mod_SLG, SLG_data[,5:9])
SLG_data$pr_RF_SLG <- predict(RF_mod_SLG, SLG_data[,5:9])
SLG_data$pr_XGB_SLG <- predict(xgb_mod_SLG,dtrain_SLG)

cbind('lasso'=wrmse(SLG_data$SLG, SLG_data$AB, SLG_data$pr_lasso_SLG),
      'RF' = wrmse(SLG_data$SLG, SLG_data$AB, SLG_data$pr_RF_SLG),
      'XGB' = wrmse(SLG_data$SLG, SLG_data$AB, SLG_data$pr_XGB_SLG))

#ê²°ê³¼
lasso        RF      XGB
[1,] 1.763389 0.9139949 1.727737
```

ëœë¤í¬ë ˆìŠ¤íŠ¸ì˜ ì˜¤ì°¨ê°€ ê°€ì¥ ì ìœ¼ë‹ˆ ì„±ëŠ¥ì´ ê°€ì¥ ì¢‹ë‹¤ê³  ë³¼ ìˆ˜ ìˆë‹¤.

ì´ì œ ì–´ë–¤ ë³€ìˆ˜ê°€ ê°€ì¥ í° ì˜í–¥ì„ ì¤¬ëŠ”ì§€ `**feature_importance**`ë¥¼ í™•ì¸í•´ë³´ì.

ë³€ìˆ˜ì˜ ì¤‘ìš”ë„ë¥¼ ì‹œê°í™”í•´ì£¼ëŠ” í•¨ìˆ˜ê°€ `varImp()`ì´ë‹¤.

```r
set.seed(1569)
RF_mod_OBP_FI <- train(x=OBP_data[,5:9], y=OBP_data$OBP, method='rf', trControl=my_control, tuneGrid=tuneGrid, importance=T)
RF_mod_SLG_FI <- train(x=SLG_data[,5:9], y=SLG_data$SLG, method='rf', trControl=my_control, tuneGrid=tuneGrid, importance=T)
par(mfrow=c(1,2))
plot(varImp(RF_mod_OBP_FI, scale=FALSE), main='RF_mod_OBP variable Importance')
plot(varImp(RF_mod_SLG_FI, scale=FALSE), main='RF_mod_SLG variable Importance')
```

<img src="https://user-images.githubusercontent.com/115082062/206626832-bbf2fe86-8f9d-4db0-932a-a6a83052c133.jpg"

<img src="https://user-images.githubusercontent.com/115082062/206627129-510a1d90-b701-4b0a-99e7-73e934b4069b.jpg">

í‰ê·  ì¶œë£¨ìœ¨/ì¥íƒ€ìœ¨ì´ ê°€ì¥ í° ì˜í–¥ì„ ì£¼ì—ˆê³ , ê·¸ ë‹¤ìŒìœ¼ë¡œ 1ë…„ì „ ì„±ì , ë‚˜ì´, 3ë…„ì „ ì„±ì , 2ë…„ì „ ì„±ì  ìˆœìœ¼ë¡œ ì˜í–¥ì„ ì¤¬ë‹¤.

ì œì¶œ íŒŒì¼ì„ ë§Œë“¤ ê²ƒì´ë‹¤. ì œì¶œ íŒŒì¼ì—” ë‚˜ì´, 1,2,3ë…„ ì „ ì„±ì , í‰ê·  ì„±ì ì„ ë„£ì–´ì¤„ ê²ƒì´ë‹¤.

```r
submission <- read.csv('submission.csv', fileEncoding = "UTF-8")

#ë‚˜ì´ë¥¼ ë§Œë“¤ê¸° ìœ„í•´ ìš°ì„  ê´€ì¸¡ë…„ë„(2019) ë³€ìˆ˜ë¥¼ ë§Œë“ ë‹¤
submission$year <- 2019

#ì„ ìˆ˜ì˜ ì¶œìƒë…„ë„ ì •ë³´ë¥¼ ë‹´ì€ í…Œì´ë¸”ì„ ë§Œë“ ë‹¤
regular_season_batter_year_born <- regular_season_batter %>%
  select(batter_id, batter_name, year_born)
regular_season_batter_year_born <- distinct(regular_season_batter_year_born)

submission <- left_join(submission, regular_season_batter_year_born, by=c('batter_id', 'batter_name'))
submission <- submission %>%
  mutate(age= year-as.numeric(substr(year_born,1,4)))

#OBPì™€ SLGë¥¼ ë”°ë¡œ ë§Œë“¤ì–´ì£¼ê³  ë‚˜ì¤‘ì— í•©ì¹œë‹¤
submission_OBP <- submission
submission_SLG <- submission
```

OBPë¶€í„° ë§Œë“¤ì–´ì¤€ë‹¤.

```r
submission_OBP <- left_join(submission_OBP, sum_hf_yr_OBP %>%
                              select(batter_name, mean_OBP) %>%
                              distinct(), by='batter_name')

#1,2,3ë…„ ì „ OBPë¥¼ ì¶”ê°€í•´ì¤€ë‹¤
for(i in c(1,2,3)){
  lag_data <- sum_hf_yr_OBP %>% 
    filter(year==2019-i & AB>=30) %>% 
    select(batter_name, OBP)
    colnames(lag_data)[2] <- paste0("lag",i,"_OBP")
    submission_OBP <- left_join(submission_OBP, lag_data, by='batter_name')
}
```

## 6. ì‚¬í›„ ê²°ì¸¡ì¹˜ ë³´ê°„

í…Œì´ë¸”ì„ ì—´ì–´ë³´ë©´ ê²°ì¸¡ì¹˜ê°€ ê½¤ ë§ë‹¤. ê²°ì¸¡ì¹˜ë“¤ì´ ê°ê°ì˜ ì´ìœ ë¡œ ê²°ì¸¡ë˜ì—ˆê¸° ë•Œë¬¸ì— ê²½ìš°ì— ë§ëŠ” ì²˜ë°©ì„ í•´ì¤˜ì•¼í•œë‹¤.

ìš°ì„  Day_by_Day ë°ì´í„°ì— ëˆ„ë½ë˜ì–´ ê²°ì¸¡ì¹˜ì¸ ì„ ìˆ˜ë“¤ì˜ ê²½ìš°ì´ë‹¤.

```r
for( i in c('ê¹€ì£¼ì°¬','ì´ë²”í˜¸')){
  row_index <- which(submission_OBP$batter_name==i)
  submission_OBP[row_index,]$mean_OBP <- regular_season_batter %>%
    filter(AB>=30 & (batter_name==i)) %>%
    mutate(mean_OBP = sum(AB*OBP)/sum(AB)) %>%
    select(mean_OBP) %>% 
    unique()
  submission_OBP[row_index,]$lag1_OBP <- regular_season_batter %>%
    filter(AB>=30 & (batter_name==i)) %>%
    filter(year==2018) %>%
    select(OBP)
  submission_OBP[row_index,]$lag2_OBP <- regular_season_batter %>%
    filter(AB>=30 & (batter_name==i)) %>%
    filter(year==2017) %>%
    select(OBP)
  submission_OBP[row_index,]$lag3_OBP <- regular_season_batter %>%
    filter(AB>=30 & (batter_name==i)) %>%
    filter(year==2016) %>%
    select(OBP)
}
```

ë‹¤ìŒìœ¼ë¡œ ê°“ ì²« ì‹œì¦Œì„ ì¹˜ë¤„ í‰ê·  OBPê°€ ì—†ëŠ” ì„ ìˆ˜ë“¤ì˜ ê²½ìš°ì´ë‹¤. ì´ ë•Œ ì‹œì¦Œ í‰ê·  OBPë¡œ ê²°ì¸¡ì¹˜ë¥¼ ë§¤ê¿”ì¤€ë‹¤.

```r
row_index <- which(submission_OBP$batter_name %in% c('ê³ ëª…ì„±','ì „ë¯¼ì¬','ê¹€ì² í˜¸','ì‹ ë²”ìˆ˜','ì´ë³‘íœ˜'))
for (i in row_index) submission_OBP[i,]$mean_OBP <- season_OBP_mean %>%
  filter(year==2018) %>%
  select(mean_OBP)
```

ìƒŒì¦ˆì™€ ì „ë³‘ìš°ëŠ” 2018ë…„ í›„ë°˜ê¸° ì„±ì ë§Œ ìˆì–´ì„œ ê²°ì¸¡ì¹˜ê°€ ìƒê¸´ë‹¤.

```r
for(i in c('ì „ë³‘ìš°','ìƒŒì¦ˆ')){
  row_index <- which(submission_OBP$batter_name==i)
  submission_OBP[row_index,]$mean_OBP <- regular_season_batter %>%
    filter(AB>=30 & (batter_name==i)) %>%
    mutate(mean_OBP = sum(AB*OBP)/sum(AB)) %>% select(mean_OBP) %>% unique()
  submission_OBP[row_index,]$lag1_OBP <- regular_season_batter %>%
    filter(AB>=30 & (batter_name==i)) %>%
    filter(year==2018) %>% select(OBP)
}
```

ë‚˜ë¨¸ì§€ ê²°ì¸¡ì¹˜ë“¤ì€ ì€í‡´í–ˆê±°ë‚˜, 1êµ° ê¸°ëŸ‰ì„ ë³´ì—¬ì£¼ì§€ ëª»í•œ ì„ ìˆ˜ë“¤ì´ë¯€ë¡œ í•˜ìœ„ 25%ì„±ì ìœ¼ë¡œ ê²°ì¸¡ì¹˜ë¥¼ ë§¤ê¿”ì¤„ ê²ƒì´ë‹¤.

```r
below_25_index <- which(is.na(submission_OBP$mean_OBP))
submission_OBP$mean_OBP[below_25_index] <- quantile(player_OBP_mean$mean_OBP, 0.25)

submission_OBP[which(sapply(submission_OBP,is.list))] <- sapply(submission_OBP[which(sapply(submission_OBP, is.list))], unlist)
for(i in c(1,2,3)) submission_OBP <- lag_na_fill(submission_OBP,"OBP",i,season_OBP_mean)
```

ì´ì œ SLGë„ OBPì™€ ë™ì¼í•œ ê³¼ì •ì„ ë°Ÿìœ¼ë©´ ëœë‹¤. ìš°ì„  1,2,3ë…„ ì „ SLG ì„±ì  ì—´ì„ ë§Œë“¤ì–´ì¤€ë‹¤.

```r
submission_SLG <- left_join(submission_SLG, sum_hf_yr_SLG %>% select(batter_name, mean_SLG) %>% distinct(), by = "batter_name")

for(i in c(1,2,3)){
  lag_data <- sum_hf_yr_SLG %>% filter(year == 2019 - i & AB >= 30) %>% select(batter_name, SLG)
  colnames(lag_data)[2] <- paste0("lag",i,"_SLG")
  submission_SLG <- left_join(submission_SLG, lag_data, by="batter_name")
}
```

ì•ì„œ ì‚´í´ë³¸ 4ê°€ì§€ ê²½ìš°ì— ë”°ë¼ ê²°ì¸¡ì¹˜ë¥¼ ë§¤ê¿”ì¤€ë‹¤.

```r
case1_name <-c("ê¹€ì£¼ì°¬", "ì´ë²”í˜¸")

for(i in case1_name){
  row_index <- which(submission_SLG$batter_name == i)
  
  submission_SLG[row_index,]$mean_SLG <- regular_season_batter %>% filter(AB>=30 & (batter_name ==i)) %>%
    mutate(mean_SLG = sum(AB * SLG)/sum(AB)) %>% select(mean_SLG) %>% unique()
  
  submission_SLG[row_index,]$lag1_SLG <- regular_season_batter %>% filter(AB>=30 & (batter_name ==i)) %>% 
    filter(year == 2018) %>% select(SLG) %>% as.numeric()
  
  submission_SLG[row_index,]$lag2_SLG <- regular_season_batter %>% filter(AB>=30 & (batter_name ==i)) %>% 
    filter(year == 2017) %>% select(SLG) %>% as.numeric()
  
  submission_SLG[row_index,]$lag3_SLG <- regular_season_batter %>% filter(AB>=30 & (batter_name ==i)) %>% 
    filter(year == 2016) %>% select(SLG) %>% as.numeric()
  
}
```

```r
row_index <- which(submission_SLG$batter_name %in% c("ê¹€ì² í˜¸","ì‹ ë²”ìˆ˜", "ì´ë³‘íœ˜", "ì „ë¯¼ì¬","ê³ ëª…ì„±"))
for(i in row_index) submission_SLG[i,]$mean_SLG <- season_SLG_mean %>% filter(year == 2018) %>% select(mean_SLG)
```

```r
for(i in c("ìƒŒì¦ˆ", "ì „ë³‘ìš°")){
  row_index <- which(submission_SLG$batter_name == i)
  submission_SLG[row_index,]$mean_SLG <- regular_season_batter %>% filter(AB>=30 & (batter_name == i)) %>%
    mutate(mean_SLG = sum(AB * SLG)/sum(AB)) %>% select(mean_SLG) %>% unique()
  
  submission_SLG[row_index,]$lag1_SLG <- regular_season_batter %>% filter(AB>=30 & (batter_name ==i)) %>% filter(year == 2018) %>% select(SLG)
}
```

```r
below_25_index <- which(is.na(submission_SLG$mean_SLG))
submission_SLG$mean_SLG[below_25_index] <- quantile(player_SLG_mean$mean_SLG, 0.25)

submission_SLG[which(sapply(submission_SLG, is.list))] <- sapply(submission_SLG[which(sapply(submission_SLG, is.list))], unlist)

for(i in c(1,2,3)) submission_SLG <- lag_na_fill(submission_SLG, "SLG", i, season_SLG_mean)
```

ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ `predict()`í•¨ìˆ˜ë¥¼ ì´ìš©í•´ ì˜ˆì¸¡ì„ ì§„í–‰í•œë‹¤.

```r
#ì˜ˆì¸¡ì— ìš©ì´í•˜ê²Œ ì—´ ìˆœì„œë¥¼ ë°”ê¾¸ê³  í–‰ì„ ì •ë ¬í•œë‹¤.
submission_OBP <- submission_OBP %>%
  select(c(1:5,7:9,6)) %>%
  arrange(batter_id)
submission_SLG <- submission_SLG %>%
  select(c(1:5,7:9,6)) %>%
  arrange(batter_id)

predict_OBP <- predict(RF_mod_OBP, submission_OBP[,5:9])
predict_SLG <- predict(RF_mod_SLG, submission_SLG[,5:9])

final_submission <- submission %>% select(batter_id, batter_name)
final_submission$OPS <- predict_OBP+predict_SLG

final_submission$OPS <- final_submission$OPS - 0.035
write.csv(final_submission, "Final_Submission.csv", row.names = FALSE)
```
