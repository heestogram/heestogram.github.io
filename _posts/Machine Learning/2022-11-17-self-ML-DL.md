---
title: "[ML] í˜¼ê³µë¨¸ë‹ 1í¸ k-Nearest Neighbors(k-ìµœê·¼ì ‘ ì´ì›ƒ)"
excerpt: "k-ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ê³¼ test, train set ê·¸ë¦¬ê³  í‘œì¤€í™”ì— ëŒ€í•´ ì•Œì•„ë³´ì"

toc: true
toc_label: "ëª©ì°¨"
toc_sticky: true

tags: [k-ìµœê·¼ì ‘ì´ì›ƒ, ML]

published: true

categories:
  - ML

date: 2022-11-17 12:38:30 +09:00 
last_modified_at: 2022-11-17 12:38:30 +09:00
---

<div class="notice--primary" markdown="1">
ğŸ’¡ â€˜í˜¼ì ê³µë¶€í•˜ëŠ” ë¨¸ì‹ ëŸ¬ë‹ ë”¥ëŸ¬ë‹(ë°•í•´ì„  ì €)â€™ ì±…ì„ ì½ê³  ê³µë¶€í•œ ë‚´ìš©ì„ ìš”ì•½í•œ í˜ì´ì§€ì…ë‹ˆë‹¤.<br>
ì±…ì— ë‚˜ì˜¤ëŠ” ì½”ë“œë¥¼ ê·¸ëŒ€ë¡œ ì“°ì§€ ì•Šê³ , ì½”ë“œì™€ íŒŒë¼ë¯¸í„°ë¥¼ ë³€í˜•í•˜ê³  ì¡°ì •í•´ê°€ë©° ë‹¤ë¥¸ ê²°ê³¼ë¥¼ ì¶œë ¥í•˜ë©° ê³µë¶€í–ˆìŠµë‹ˆë‹¤.
</div>

<br>

## 01. K-Nearest Neighbor(K-ìµœê·¼ì ‘ ì´ì›ƒ)


### **01-1. ë„ë¯¸, ë¹™ì–´ ë°ì´í„°ë¡œ K-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜í•˜ê¸°**

ìƒì„  ì¤‘ì— ë¬´ì—‡ì´ ë„ë¯¸ì´ê³  ë¬´ì—‡ì´ ë¹™ì–´ì¸ì§€ ì•Œë ¤ì£¼ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•´ë³´ì.

```python
# ë„ë¯¸ ë°ì´í„° ì¤€ë¹„í•˜ê¸°
bream_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0, 
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0, 
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0]
bream_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0, 
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0, 
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0]

# ë¹™ì–´ ë°ì´í„° ì¤€ë¹„í•˜ê¸°
smelt_length = [9.8, 10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
smelt_weight = [6.7, 7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]

import matplotlib.pyplot as plt #ê³¼í•™ê³„ì‚°ìš© ê·¸ë˜í”„ ê·¸ë¦¬ëŠ” íŒ¨í‚¤ì§€ 'ë§·í”Œë¡¯ë¦½'

plt.scatter(bream_length, bream_weight)
plt.xlabel('length') #xì¶• ì„¤ì •
plt.ylabel('weight') #yì¶• ì„¤ì •
plt.show()
```

- **k-ìµœê·¼ì ‘ ì´ì›ƒ(k-Nearest Neighbors) ì•Œê³ ë¦¬ì¦˜:** ì–´ë–¤ ë°ì´í„°ì— ëŒ€í•´ ë‹µì„ êµ¬í•  ë•Œ ì£¼ìœ„ì˜ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ë³´ê³  ë‹¤ìˆ˜ë¥¼ ì°¨ì§€í•˜ëŠ” ê²ƒì„ ì •ë‹µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜.


```python
length = bream_length + smelt_length
weight = bream_weight + smelt_weight
fish_data = [[l,w] for l, w in zip(length, weight)] #ë¦¬ìŠ¤íŠ¸ ë‚´í¬ êµ¬ë¬¸
#ì´ëŸ¬ë©´ 2ì°¨ì› ë¦¬ìŠ¤íŠ¸ê°€ ë§Œë“¤ì–´ì§!

fish_target = [1]*35 + [0]*14 #ë„ë¯¸ëŠ” 1ë¡œ, ë¹™ì–´ëŠ” 0ìœ¼ë¡œ ë†“ëŠ”ë‹¤.
print(fish_target)

#kìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜ì„ êµ¬í˜„í•œ í´ë˜ìŠ¤
from sklearn.neighbors import KNeighborsClassifier 

kn = KNeighborsClassifier() #í´ë˜ìŠ¤ì˜ ê°ì²´ ë§Œë“¤ì–´ì£¼ê¸°
kn.fit(fish_data, fish_target) #fitë©”ì„œë“œëŠ” trainingì„ ì‹œì¼œì¤€ë‹¤.
kn.score(fish_data, fish_target) #scoreë©”ì„œë“œëŠ” ëª¨ë¸ì„ í‰ê°€í•˜ëŠ” ì ìˆ˜(ì •í™•ë„,accuracy)ë¥¼ ì•Œë ¤ì¤€ë‹¤.

kn.predict([[30,600]]) #predictë©”ì„œë“œëŠ” ìƒˆë¡œìš´ ë°ì´í„°ì˜ ì •ë‹µì„ ì˜ˆì¸¡í•œë‹¤.

#ê°€ê¹Œìš´ ëª‡ ê°œì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í• ì§€ëŠ” n_neighbors ë§¤ê°œë³€ìˆ˜ë¡œ ì •í•¨!
kn49 = KNeighborsClassifier(n_neighbors=49) #ì£¼ë³€ì˜ 49ê°œì˜ ë°ì´í„°ë¥¼ ì‚¬ìš©í•œë‹¤ëŠ” ì˜ë¯¸
kn49.fit(fish_data, fish_target)
kn49.score(fish_data, fish_target)
```

**01-1 í•µì‹¬ í‚¤ì›Œë“œ**

- íŠ¹ì„±(feature): ë°ì´í„°ë¥¼ í‘œí˜„í•˜ëŠ” í•˜ë‚˜ì˜ ì„±ì§ˆ
- k-ìµœê·¼ì ‘ ì´ì›ƒ ì•Œê³ ë¦¬ì¦˜: ì–´ë–¤ ë°ì´í„°ì— ëŒ€í•´ ë‹µì„ êµ¬í•  ë•Œ ì£¼ìœ„ì˜ ë‹¤ë¥¸ ë°ì´í„°ë¥¼ ë³´ê³  ë‹¤ìˆ˜ë¥¼ ì°¨ì§€í•˜ëŠ” ê²ƒì„ ì •ë‹µìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜. ê°€ì¥ ê°„ë‹¨í•œ ë¨¸ì‹ ëŸ¬ë‹ ì•Œê³ ë¦¬ì¦˜ ì¤‘ í•˜ë‚˜
- ì •í™•ë„(accuracy) = ì •í™•íˆ ë§íŒ ê°œìˆ˜ /  ì „ì²´ ë°ì´í„° ê°œìˆ˜

**01-1 í•µì‹¬ íŒ¨í‚¤ì§€ì™€ í•¨ìˆ˜**

- **matplotlib**
    - scatter(): ì‚°ì ë„ë¥¼ ê·¸ë¦¬ëŠ” ë§·í”Œë¡¯ë¦½ í•¨ìˆ˜
- **scikit-learn**
    - `KNeighborsClassifier()`: k-ìµœê·¼ì ‘ ì´ì›ƒ ë¶„ë¥˜ ëª¨ë¸ì„ ë§Œë“œëŠ” ì‚¬ì´í‚·ëŸ° í´ë˜ìŠ¤
    - `fit()`ì€ ì‚¬ì´í‚·ëŸ° ëª¨ë¸ì„ í›ˆë ¨í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œ
    - `predict()`ëŠ” ì‚¬ì´í‚·ëŸ° ëª¨ë¸ì„ í›ˆë ¨í•˜ê³  ì˜ˆì¸¡í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë©”ì„œë“œ
    - `score()`ì€ í›ˆë ¨ëœ ì‚¬ì´í‚·ëŸ° ëª¨ë¸ì˜ ì„±ëŠ¥ì„ ì¸¡ì •í•˜ëŠ” ë©”ì„œë“œ

<br>

## 02 ë°ì´í„° ë‹¤ë£¨ê¸°

### **02-1 í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸**

ë„ë¯¸ì™€ ë¹™ì–´ ë°ì´í„°/íƒ€ê¹ƒì„ ì£¼ê³  í›ˆë ¨í•œ ë‹¤ìŒ ê°™ì€ ë°ì´í„°ë¡œ í…ŒìŠ¤íŠ¸í•œë‹¤ë©´ ëª¨ë‘ ë§í ê²ƒì´ ë‹¹ì—°í•˜ë‹¤. ì—°ìŠµ ë¬¸ì œì™€ ì‹œí—˜ ë¬¸ì œê°€ ë‹¬ë¼ì•¼ ì˜¬ë°”ë¥´ê²Œ ëª¨ë¸ì˜ ì„±ëŠ¥ì„ í‰ê°€í•  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ í‰ê°€ì— ì‚¬ìš©í•  **test set**ì™€ í›ˆë ¨ì— ì‚¬ìš©í•  **train set**ë¥¼ ë‚˜ëˆŒ ìˆ˜ ìˆì–´ì•¼ í•œë‹¤.

```python
#ë°ì´í„° ì¤€ë¹„í•˜ê¸°
fish_length = [25.4, 26.3, 26.5, 29.0, 29.0, 29.7, 29.7, 30.0, 30.0, 30.7, 31.0, 31.0, 
                31.5, 32.0, 32.0, 32.0, 33.0, 33.0, 33.5, 33.5, 34.0, 34.0, 34.5, 35.0, 
                35.0, 35.0, 35.0, 36.0, 36.0, 37.0, 38.5, 38.5, 39.5, 41.0, 41.0, 9.8, 
                10.5, 10.6, 11.0, 11.2, 11.3, 11.8, 11.8, 12.0, 12.2, 12.4, 13.0, 14.3, 15.0]
fish_weight = [242.0, 290.0, 340.0, 363.0, 430.0, 450.0, 500.0, 390.0, 450.0, 500.0, 475.0, 500.0, 
                500.0, 340.0, 600.0, 600.0, 700.0, 700.0, 610.0, 650.0, 575.0, 685.0, 620.0, 680.0, 
                700.0, 725.0, 720.0, 714.0, 850.0, 1000.0, 920.0, 955.0, 925.0, 975.0, 950.0, 6.7, 
                7.5, 7.0, 9.7, 9.8, 8.7, 10.0, 9.9, 9.8, 12.2, 13.4, 12.2, 19.7, 19.9]

fish_data = [[l,w] for l,w in zip(fish_length, fish_weight)]
fish_target = [1]*35 + [0]*14

#ì´ 49ê°œì˜ ìƒ˜í”Œ ê°€ìš´ë° ì²˜ìŒ 35ê°œë¥¼ í›ˆë ¨ì„¸íŠ¸ë¡œ, ë‚˜ë¨¸ì§€ 14ê°œë¥¼ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ë¡œ ì“´ë‹¤. 
```

```python
from sklearn.neighbors import KNeighborsClassifier
kn = KNeighborsClassifier()
```

```python
#ì´ 49ê°œì˜ ìƒ˜í”Œ ê°€ìš´ë° ì²˜ìŒ 35ê°œë¥¼ í›ˆë ¨ì„¸íŠ¸ë¡œ, ë‚˜ë¨¸ì§€ 14ê°œë¥¼ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ë¡œ ì“´ë‹¤.
train_input = fish_data[:35] #ìŠ¬ë¼ì´ì‹±ìœ¼ë¡œ 0ë¶€í„° 34ë²ˆì§¸ ì¸ë±ìŠ¤ê¹Œì§€
train_target = fish_target[:35]
test_input = fish_data[35:]
test_target = fish_target[35:]
```

```python
kn = kn.fit(train_input, train_target)
kn.score(test_input, test_target)
#scoreë¥¼ í™•ì¸í•´ë³´ë‹ˆ 0.0ìœ¼ë¡œ ë‚˜ì™”ë‹¤. ì™œì¼ê¹Œ?
#ìƒ˜í”Œë§ì´ í¸í–¥ëœ ê²ƒ! ë‚˜ë¨¸ì§€ 14ê°œë¥¼ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë–¼ì–´ë†“ìœ¼ë©´ í›ˆë ¨ ì„¸íŠ¸ì—ëŠ” ë¹™ì–´ê°€ í•˜ë‚˜ë„ ì—†ë‹¤!
#ë”°ë¼ì„œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ì ì ˆíˆ ë¶„ë¥˜í•˜ëŠ” ê²ƒì´ ë§¤ìš° ì¤‘ìš”.
```

**ë„˜íŒŒì´**ëŠ” íŒŒì´ì¬ì˜ ëŒ€í‘œì ì¸ ë°°ì—´(array) ë¼ì´ë¸ŒëŸ¬ë¦¬ë¡œ, ê³ ì°¨ì›ì˜ ë°°ì—´ì„ ì†ì‰½ê²Œ ë§Œë“¤ ìˆ˜ ìˆë‹¤.

```python
import numpy as np
input_arr = np.array(fish_data)
target_arr = np.array(fish_target)
```

```python
#í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ì ì ˆíˆ ì„ê¸° ìœ„í•œ ëŒ€ì±…
np.random.seed(42)
index = np.arange(49) #0ë¶€í„° 48ê¹Œì§€ ì •ìˆ˜ ë°°ì—´
np.random.shuffle(index) #indexë¥¼ ë¬´ì‘ìœ„ë¡œ ì„ìŒ
print(index)

train_input = input_arr[index[:35]]
train_target = target_arr[index[:35]]
test_input = input_arr[index[35:]]
test_target = target_arr[index[35:]]

#ê·¸ë˜í”„ë¥¼ ê·¸ë ¤ì„œ ë„ë¯¸, ë¹™ì–´ ë°ì´í„°ê°€ ì˜ ì„ì˜€ëŠ”ì§€ í™•ì¸
import matplotlib.pyplot as plt
plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(test_input[:,0], test_input[:,1])
plt.show()
```

<div align=center>
<img src = "https://user-images.githubusercontent.com/115082062/202348240-ef18161d-18fd-4f0f-b239-fdeb6cee8127.png">
</div>

íŒŒë€ìƒ‰ì´ í›ˆë ¨ì„¸íŠ¸, ì£¼í™©ìƒ‰ì´ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì´ë‹¤. ê³¨ê³ ë£¨ ì˜ ì„ì¸ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

```python
kn = kn.fit(train_input, train_target)
kn.score(test_input, test_target)
kn.predict(test_input)
```

**02-1 í•µì‹¬ í‚¤ì›Œë“œ**

- **ì§€ë„í•™ìŠµ**: ì…ë ¥ê³¼ íƒ€ê¹ƒì„ ì „ë‹¬í•˜ì—¬ ëª¨ë¸ì„ í›ˆë ¨í•œ ë‹¤ìŒ ìƒˆë¡œìš´ ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ë° ì‚¬ìš©
- **ë¹„ì§€ë„í•™ìŠµ**: íƒ€ê¹ƒ ë°ì´í„°ê°€ ì—†ëŠ” í•™ìŠµ
- **í›ˆë ¨ì„¸íŠ¸**: ëª¨ë¸ì„ í›ˆë ¨í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°. ë³´í†µ í›ˆë ¨ ì„¸íŠ¸ê°€ í´ìˆ˜ë¡ ì¢‹ìŒ
- **í…ŒìŠ¤íŠ¸ì„¸íŠ¸**: ëª¨ë¸ì„ í‰ê°€í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë°ì´í„°. ë³´í†µ ì „ì²´ ë°ì´í„°ì˜ 20~30%.

**02-1 í•µì‹¬ íŒ¨í‚¤ì§€ì™€ í•¨ìˆ˜**

- **numpy**
    - `seed()`: ë„˜íŒŒì´ì—ì„œ ë‚œìˆ˜ë¥¼ ìƒì„±í•˜ê¸° ìœ„í•œ ì •ìˆ˜ ì´ˆê¸°ê°’ì„ ì§€ì •
    - `arange()`: ì¼ì •í•œ ê°„ê²©ì˜ ì •ìˆ˜ ë˜ëŠ” ì‹¤ìˆ˜ ë°°ì—´ì„ ë§Œë“¦. ê¸°ë³¸ ê°„ê²©ì€ 1
    - `shuffle`: ì£¼ì–´ì§„ ë°°ì—´ì„ ëœë¤í•˜ê²Œ ì„ìŒ.

<br>

### **02-2 ë°ì´í„° ì „ì²˜ë¦¬(í‘œì¤€í™”)**

```python
fish_data = np.column_stack((fish_length, fish_weight)) 
# cloumn_stackì€ ì „ë‹¬ë°›ì€ ë¦¬ìŠ¤íŠ¸ë¥¼ ì¼ë ¬ë¡œ ì„¸ìš´ ë‹¤ìŒ ì°¨ë¡€ëŒ€ë¡œ ì—°ê²°
fish_target = np.concatenate((np.ones(35), np.zeros(14)))
# onesì€ 1ì„ nê°œë§Œí¼ ë°°ì—´ë¡œ ë§Œë“¤ê³  zerosëŠ” 0ì„ nê°œë§Œí¼ ë°°ì—´ë¡œ ë§Œë“¦
```

ì‚¬ì´í‚·ëŸ°(**`train_test_split` í•¨ìˆ˜**)ìœ¼ë¡œ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ë°ì´í„° ë‚˜ëˆ„ê¸°

```python
from sklearn.model_selection import train_test_split
train_input, test_input, train_target, test_target = train_test_split(fish_data, fish_target, stratify=fish_target, random_state=42)
#straifyë§¤ê°œë³€ìˆ˜ì— íƒ€ê¹ƒë°ì´í„°ë¥¼ ì „ë‹¬í•˜ë©´ í´ë˜ìŠ¤ ë¹„ìœ¨ì— ë§ê²Œ ë°ì´í„°ë¥¼ ë‚˜ëˆ”
print(test_target)
```

```python
print(kn.predict([[25,150]])) #ê¸¸ì´ê°€ 25ì´ê³  ë¬´ê²Œê°€ 150ì¸ ìƒì„ ì„ ì˜ˆì¸¡
#ì›ë˜ëŒ€ë¡œë¼ë©´ ë„ë¯¸ë¡œ ì˜ˆì¸¡í•´ì•¼ í•˜ëŠ”ë° ë¹™ì–´ë¡œ ì˜ˆì¸¡í•´ë²„ë¦¼. ì™œì¼ê¹Œ?

distance, indexes = kn.kneighbors([[25,150]])
print(distance, indexes)
plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(train_input[indexes,0], train_input[indexes,1], marker ='D')
plt.scatter(25,150, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```
<div align = center>
<img src = "https://user-images.githubusercontent.com/115082062/202348483-f3719d19-e099-4204-8d67-8d6d8a02615c.png">
</div>

ì‚¼ê°í˜•ì´ ì˜ˆì¸¡ëŒ€ìƒì´ê³ , ì£¼í™©ìƒ‰ì´ ì¸ì ‘í•œ 5ê°œì˜ ìƒ˜í”Œì´ë‹¤. ê°€ê¹ê¸°ë¡  ìš°ì¸¡ìƒë‹¨ì˜ ë„ë¯¸ë“¤ì´ ë” ê°€ê¹Œì›Œë³´ì´ëŠ”ë°, í›¨ì”¬ ë©€ì–´ë³´ì´ëŠ” ë¹™ì–´ê°€ ì¸ì ‘í•œ ìƒ˜í”Œë¡œ ë¶„ë¥˜ë˜ì—ˆë‹¤.

ìœ„ê°™ì€ ì°©ì‹œê°€ ì¼ì–´ë‚˜ëŠ” ê²ƒì€ yì¶•ì˜ ë²”ìœ„ê°€ xì¶•ì— ë¹„í•´ í›¨ì”¬ ë„“ê¸° ë•Œë¬¸ì´ë‹¤. ë‘ ì¶•ì˜ ë²”ìœ„ë¥¼ ê°™ê²Œ í•´ë³´ì.

```python
plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(train_input[indexes,0], train_input[indexes,1], marker ='D')
plt.scatter(25,150, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.xlim((0,1000)) #xì¶•ì˜ ë²”ìœ„ë¥¼ 1000ìœ¼ë¡œ ë„“í˜€ yì¶•ê³¼ ê°™ì€ ìŠ¤ì¼€ì¼ë¡œ ë§Œë“¤ì–´ë³´ì
plt.show()
```

<div align = center>
<img src="https://user-images.githubusercontent.com/115082062/202348591-ca81c1e3-1155-445a-aaa7-e84fb09a5538.png">

</div>

ì´ì œì•¼ ë‚©ë“ì´ ê°€ëŠ” ì‹¤ì œ ê±°ë¦¬

ë‘ íŠ¹ì„±ì˜ scaleì´ ë‹¤ë¥´ê¸° ë•Œë¬¸ì— ìƒê¸´ ì¼ì´ë‹¤. ìŠ¤ì¼€ì¼ì´ ìƒì´í•˜ë‹¤ë©´ k-ìµœê·¼ì ‘ ì•Œê³ ë¦¬ì¦˜ì€ ì˜¬ë°”ë¥¸ ì˜ˆì¸¡ì„ í•  ìˆ˜ ì—†ë‹¤. ë•Œë¬¸ì— íŠ¹ì„±ê°’ì„ **ì „ì²˜ë¦¬(preprocessing)** í•´ì¤˜ì•¼ í•œë‹¤. ê°€ì¥ ë„ë¦¬ ì‚¬ìš©í•˜ëŠ” ì „ì²˜ë¦¬ ë°©ë²• ì¤‘ í•˜ë‚˜ëŠ” **í‘œì¤€ì ìˆ˜(standard score)** ì´ë‹¤.


```python
mean = np.mean(train_input, axis=0) #í‰ê· 
std = np.std(train_input, axis=0) #í‘œì¤€í¸ì°¨
train_scaled = (train_input-mean)/std #í‘œì¤€ì ìˆ˜
```

```python
new = ([25, 150] - mean)/std
plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(new[0],new[1], marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()

kn.fit(train_scaled, train_target)
kn.score(test_scaled, test_target)
print(kn.predict([new]))

distance, indexes = kn.kneighbors([new])
new = ([25, 150] - mean)/std
plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(train_scaled[indexes,0], train_scaled[indexes,1], marker='D')
plt.scatter(new[0],new[1], marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```
<div align = center>

<img src="https://user-images.githubusercontent.com/115082062/202348866-0a12cb73-575c-45a1-92f9-9fc6213720a1.png">
</div>

í‘œì¤€ì ìˆ˜ë¡œ ì „ì²˜ë¦¬í•´ì¤€ í›„ì—” ì•Œê³ ë¦¬ì¦˜ì´ ì œëŒ€ë¡œ ì‘ë™í•˜ê²Œ ëœë‹¤.

**02-2 í•µì‹¬ í‚¤ì›Œë“œ**

- **ë°ì´í„° ì „ì²˜ë¦¬(data-preprocessing)**: í›ˆë ¨ë°ì´í„°ë¥¼ ì£¼ì…í•˜ê¸° ì „ ê°€ê³µí•˜ëŠ” ë‹¨ê³„
- í‘œì¤€ì ìˆ˜: íŠ¹ì„±ì— í‰ê· ì„ ë¹¼ê³  í‘œì¤€í¸ì°¨ë¡œ ë‚˜ëˆ”. ë°˜ë“œì‹œ í›ˆë ¨ì„¸íŠ¸ì˜ í‰ê· ê³¼ í‘œì¤€í¸ì°¨ë¡œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ë°”ê¿”ì•¼ í•¨
- ë¸Œë¡œë“œìºìŠ¤íŒ…: í¬ê¸°ê°€ ë‹¤ë¥¸ ë„˜íŒŒì´ ë°°ì—´ì—ì„œ ìë™ìœ¼ë¡œ ì‚¬ì¹™ ì—°ì‚°ì„ ëª¨ë“  í–‰ì´ë‚˜ ì—´ë¡œ í™•ì¥í•˜ì—¬ ìˆ˜í–‰í•˜ëŠ” ê¸°ëŠ¥

**02-2 í•µì‹¬ íŒ¨í‚¤ì§€ì™€ í•¨ìˆ˜**

- **scikit-learn**
    - **`train_test_split()`**: í›ˆë ¨ì„¸íŠ¸, í…ŒìŠ¤íŠ¸ì„¸íŠ¸ë¥¼ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜. test_size ë§¤ê°œë³€ìˆ˜ë¡œ í…ŒìŠ¤íŠ¸ì„¸íŠ¸ì˜ ë¹„ìœ¨ ì§€ì • ê°€ëŠ¥.
    - `kneighbors()`: ì…ë ¥í•œ ë°ì´í„°ì˜ ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒì„ ì°¾ì•„ ê±°ë¦¬ì™€ ì´ì›ƒ ìƒ˜í”Œì˜ ì¸ë±ìŠ¤ë¥¼ ë°˜í™˜.
